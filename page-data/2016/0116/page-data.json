{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016/0116/","result":{"data":{"site":{"siteMetadata":{"title":"なばろぐ","description":"プログラミング、ピアノ作曲・演奏、雑記など"}},"markdownRemark":{"html":"<div class=\"alert info\">\nはてなブログからの移行記事\n</div>\n<h2>環境構築したもの</h2>\n<h3>Windows 10 Home</h3>\n<ul>\n<li>Vagrant</li>\n<li>VirtualBox</li>\n</ul>\n<h3>仮想環境</h3>\n<ul>\n<li>CentOS 7.0 x86_64</li>\n<li>Apache 2.4.6</li>\n<li>MySQL 5.7.10</li>\n<li>PHP 7.0.2</li>\n</ul>\n<!-- more -->\n<br>\n<h1>Vagrant</h1>\n<p>これを使うとVirtualBoxの設定画面をいちいち弄ったり、ゲストOSをインストールしなくて済みます。便利（昨日知りました）</p>\n<p>[f:id:naba0123:20160116171819p:plain:w450]</p>\n<p>[https://www.vagrantup.com/]</p>\n<br>\n<h1>VirtualBox</h1>\n<p>仮想環境を作る</p>\n<p>[https://www.virtualbox.org/:title]</p>\n<p>今回は、最新版の5.0を使用しています。</p>\n<br>\n<br>\n<h1>Vagrantの設定</h1>\n<ul>\n<li>\n<p>コマンドプロンプトを立ち上げて、仮想環境のフォルダを作成します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mkdir centos\ncd centos</code></pre></div>\n</li>\n</ul>\n<br>\n<p>続けて、以下のコマンドを実行</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vagrant box add CentOS https://f0fff3908f081cb6461b407be80daf97f07ac418.googledrive.com/host/0BwtuV7VyVTSkUG1PM3pCeDJ4dVE/centos7.box\nvagrant plugin install vagrant-vbguest</code></pre></div>\n<p>1行目は、vagrantのboxを指定。以下から目的のboxを探して下さい。</p>\n<p>[http://www.vagrantbox.es/:title]</p>\n<p>2行目は、VirtualBoxのGuest Additionsを使用するためのプラグインで、私の環境ではインストールしないとエラーが出ました。</p>\n<p>[http://qiita.com/isaoshimizu/items/e217008b8f6e79eccc85:embed:cite]</p>\n<br>\n<p>仮想環境を作成します</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vagrant init CentOS\nnotepad.exe Vagrantfile</code></pre></div>\n<p>メモ帳でコンフィグファイルが開くので、以下のように設定</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Vagrant.configure(2) do |config|\n  config.vm.box = &quot;CentOS7&quot;\n  config.vm.network &quot;private_network&quot;, ip: &quot;192.168.33.10&quot; (←コメントアウトを外す)\n  config.vm.synced_folder &quot;../hello&quot;, &quot;/var/www/html/hello&quot; (←お好みで設定、後述)\n  config.vm.provider &quot;virtualbox&quot; do |vb| (←コメントアウトを外す)\n    vb.memory = &quot;1024&quot; (←コメントアウトを外す)\n  end (←コメントアウトを外す)\nend</code></pre></div>\n<p><strong>config.vm.synced_folder</strong>は、CentOSとHostの共有フォルダになります。<br>\n上記の場合だと、ホストの”../hello”フォルダと、ゲストの”/var/www/html/hello”フォルダが共有されることになります。</p>\n<br>\n<p>設定は以上です、仮想環境を起動します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vagrant up\n\nvagrant halt (←停止するとき)\nvagrant reload (←再起動するとき)</code></pre></div>\n<p><br><br></p>\n<h1>SSHで接続</h1>\n<p>起動したので、SSHで接続します。<br>\nWindowsにはコマンドラインで使えるSSHクライアントがデフォルトではないので、今回はputtyを使います。</p>\n<p>[http://www.chiark.greenend.org.uk/~sgtatham/putty/:title]</p>\n<ul>\n<li>ホスト名：192.168.33.10</li>\n<li>ポート番号：22</li>\n</ul>\n<p>[f:id:naba0123:20160116180844p:plain:w450]</p>\n<p>文字コードはUTF-8にしないと日本語が文字化けます。</p>\n<ul>\n<li>ユーザー名：vagrant</li>\n<li>パスワード：vagrant</li>\n</ul>\n<p><br><br></p>\n<h1>CentOSの設定</h1>\n<p>環境構築の時のみルート権限になっておきます</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ su -</code></pre></div>\n<p>完全ローカルの開発環境なので、ファイアウォールとSELinuxをオフにします</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># systemctl stop firewalld\n# systemctl disable firewalld\n\n# vi /etc/sysconfig/selinux\n&gt; SELINUX=disabled (書き換え)</code></pre></div>\n<br>\n<h3>yumリポジトリの追加</h3>\n<p>PHP7を入れる時などに、デフォルトのリポジトリでは5.3などとバージョンが古いので、別のリポジトリを追加しておきます。</p>\n<p>しかし、デフォルトでオフにしておき、必要に応じて使うように設定しておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum install wget\n# wget http://ftp.iij.ad.jp/pub/linux/fedora/epel/7/x86_64/e/epel-release-7-5.noarch.rpm\n# wget http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\n# wget http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm\n# rpm -Uvh epel-release-7-5.noarch.rpm remi-release-7.rpm rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm</code></pre></div>\n<p>それぞれ、最新は以下から確認できます。</p>\n<p>epel : [https://fedoraproject.org/wiki/EPEL/ja]</p>\n<p>remi : [http://rpms.famillecollet.com/]</p>\n<p>rpmforge : [http://pkgs.repoforge.org/rpmforge-release/]</p>\n<br>\n<p>デフォルトでオフになるように設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># vi /etc/yum.repos.d/epel.repo\n&gt; [epel] を enabled=0 に\n# vi /etc/yum.repos.d/epel.repo\n&gt; [remi] を enabled=0 に (私の環境ではデフォルトでオフでした)\n# vi /etc/yum.repos.d/rpmforge.repo\n&gt; [rpmforge] を enabled=0 に</code></pre></div>\n<br>\n<p>どのリポジトリがデフォルトでオンになっているかは、以下のコマンドで確認できます</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum repolist all</code></pre></div>\n<p>[http://codaholic.org/?p=1853:title]</p>\n<br>\n<h3>日本時刻の設定</h3>\n<p>vagrantから導入すると、世界標準時になっているので、日本時間に変更します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum install ntp\n# vi /etc/ntp.conf\n&gt; serverを以下に書き換え\nserver -4 ntp.nict.jp\nserver -4 ntp1.jst.mfeed.ad.jp\nserver -4 ntp2.jst.mfeed.ad.jp\nserver -4 ntp3.jst.mfeed.ad.jp\n\n# systemctl start ntpd\n# systemctl enable ntpd.service</code></pre></div>\n<br>\n<ul>\n<li>タイムゾーンの変更</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># timedatectl set-timezone Asia/Tokyo\n# timedatectl (Asia/Tokyoになっていることを確認)</code></pre></div>\n<p><br><br></p>\n<h1>Apache</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum install httpd\n# systemctl enable httpd.service</code></pre></div>\n<p><br><br></p>\n<h1>PHP</h1>\n<p>前述のとおり、デフォルトのyumリポジトリではPHP5.3なので、remiのリポジトリを使用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum --enablerepo=remi-php70 install php php-pear php-devel php-mbstring php-mysql php-pdo php-xml</code></pre></div>\n<p>確認画面でPHP7.0であることを確認してインストールします。</p>\n<p>Apacheで使えるようにモジュールをincludeしておきます</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># vi /etc/httpd/conf.d/php.conf\n&gt; LoadModule php7_module   /usr/lib64/httpd/modules/libphp7.so (←先頭行に追加)</code></pre></div>\n<p><br><br></p>\n<h1>MySQL</h1>\n<p>MySQLのyumリポジトリを追加してそこからインストールします。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># wget http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm\n# rpm -Uvh mysql57-community-release-el7-7.noarch.rpm\n# yum --enablerepo=mysql57-community install mysql-community-server\n# systemctl enable mysqld.service</code></pre></div>\n<p>[http://dev.mysql.com/downloads/repo/yum/:title]</p>\n<br>\n<p>MySQLは5.7から、rootユーザの初期パスワードがMySQLのログに書かれています。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># cat /var/log/mysqld.log | grep &#39;password is generated&#39;\n&gt; [Note] A temporary password is generated for root@localhost: ********\n# mysql -u root -p****** (ログイン)</code></pre></div>\n<p>[http://qiita.com/ma_me/items/ae449ad8a2c424665310:embed:cite]</p>\n<p><br><br><br></p>\n<p>以上で完了です。後はお好きに開発を進められますね。</p>\n<p>思い出しながら書いたので、忘れていることがあったらゴメンナサイ。</p>","frontmatter":{"title":"VagrantとVirtualBoxでLAMP開発環境を整える(CentOS7/PHP7)","date":"2016/01/16 19:28","tags":["その他プログラミング系"]},"id":"0c9c4c7c-2b5c-5378-a834-777f0c4ec1ef","excerpt":"環境構築したもの Windows 10 Home Vagrant VirtualBox 仮想環境 CentOS 7.0 x86_64 Apache 2.4.6 MySQL 5.7.10 PHP 7.0.2 Vagrant これを使うとVirtualBox…"},"relatedPosts":{"edges":[{"node":{"fields":{"slug":"/2016/0919/"},"frontmatter":{"title":"IntelliJ ベース IDEA の背景画像を変更する方法","date":"2016/09/19 01:24","tags":["その他プログラミング系"]},"id":"5f84698a-b78d-5868-91dd-cc1a5c152ff7"}},{"node":{"fields":{"slug":"/2016/0119/"},"frontmatter":{"title":"VagrantでBox追加時にエラーが出た時の話","date":"2016/01/19 22:02","tags":["その他プログラミング系"]},"id":"ba43349e-d56c-525f-a476-84b80463d051"}},{"node":{"fields":{"slug":"/2016/0116/"},"frontmatter":{"title":"VagrantとVirtualBoxでLAMP開発環境を整える(CentOS7/PHP7)","date":"2016/01/16 19:28","tags":["その他プログラミング系"]},"id":"0c9c4c7c-2b5c-5378-a834-777f0c4ec1ef"}},{"node":{"fields":{"slug":"/2016/0104/"},"frontmatter":{"title":"PHPStormは１ヶ月の体験期間が終わっても（一応）使える","date":"2016/01/04 21:51","tags":["その他プログラミング系"]},"id":"4dbed4a1-8fdc-5946-ac5a-96597821980b"}}]}},"pageContext":{"slug":"/2016/0116/","tags":["その他プログラミング系"]}}}