{"componentChunkName":"component---src-templates-blog-post-js","path":"/2016/0116-vagrant-lamp/","result":{"data":{"site":{"siteMetadata":{"title":"なばろぐ","description":"プログラミング、ピアノ作曲・演奏、雑記など"}},"markdownRemark":{"html":"<div class=\"alert info\">\nはてなブログからの移行記事\n</div>\n<h1>環境構築したもの</h1>\n<h2>Windows 10 Home 側</h2>\n<ul>\n<li>Vagrant</li>\n<li>VirtualBox</li>\n</ul>\n<h2>仮想環境側</h2>\n<ul>\n<li>CentOS 7.0 x86_64</li>\n<li>Apache 2.4.6</li>\n<li>MySQL 5.7.10</li>\n<li>PHP 7.0.2</li>\n</ul>\n<h1>Vagrant について</h1>\n<p>これを使うと VirtualBox の設定画面をいちいち弄ったり、ゲスト OS を手動でインストールしなくて済みます。</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACXElEQVQozy1SSU8UQRTu/+Kv8KqeNNEDS2LEgwcTrsaFaHT0ZghcNDFeNBH1AhoIkWWQEYwDxpYJi7LINmFm7GF6rX3p6Q7D6y6SL1XvvXrfe1XfK0tJAuCcSIFzA2McJQKlCkEkVqTTxo7nhQTBKUQAWhKtMpYV55sQBIy2IkKSoaX6+Pr/FYdpzQ696G3luFBGCzXeiTGkmWRYoYRFGOYCp5oetPy9VpBg92Vp69yQ3TvWcLzgxcK/86/WuifxoeNJFkpJgYYYlQJuQayNuhtglGiCSEQkW7VXJ8dmuwqfLg58GXyz2Pds9MLA1PBIeb38s95whGJKYtOWA9lY+ctxElP7h11ZsgdfT/cUpnqfzF2987H7cbH41S4XF5uNervNjTQGGVlwkCFzCCW1w6q9sPTh3dSlruHbD8dv3fs88HTi9/fl/Z1dFHqxpoZmlLO0ooYsOeYMw3F1b39n4++jB+/7+0fu352Yn7HXflWUoqCf4OhMcAWCU8tIH0MJiggKQfM0EZ1O7Lvh5OjKynL1JFVJm2ezEVgwZOYE/QTDVtaQ41YU5UAurGHY8AKfoIjhgOG6FxwHoRdFzTBLAJsqWtuqVTeOLJ0Lhihu+KEXQh60DFph0PT9o5bv+AEE/SiDG/iO50N1qSjDUDmyjABwW8rJtss2Xbblsm0vMyLQL6SbLgfXRMCNZf7DNEhAM7KU5ETjPy3WPZfcKKU3v6XX55MrM2mxKp5X9OXptGcu6Ssl12bTgq1jmT0+BznrbIZ+ELA9n+0DcoNw2sR0N3chuOsxB1PznVVe4hTCMKyn41ibQwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vagrant\"\n        title=\"vagrant\"\n        src=\"/static/9b1950f8e16247b73699bf8b84dbc525/e17e5/20160116171819.png\"\n        srcset=\"/static/9b1950f8e16247b73699bf8b84dbc525/7e516/20160116171819.png 100w,\n/static/9b1950f8e16247b73699bf8b84dbc525/772e8/20160116171819.png 200w,\n/static/9b1950f8e16247b73699bf8b84dbc525/e17e5/20160116171819.png 400w,\n/static/9b1950f8e16247b73699bf8b84dbc525/0a47e/20160116171819.png 600w,\n/static/9b1950f8e16247b73699bf8b84dbc525/5a190/20160116171819.png 800w,\n/static/9b1950f8e16247b73699bf8b84dbc525/966a0/20160116171819.png 944w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">vagrant</figcaption>\n  </figure></p>\n<p><a href=\"https://www.vagrantup.com/\">https://www.vagrantup.com/</a></p>\n<h1>VirtualBox</h1>\n<p>仮想環境自体を管理するソフトウェアです。</p>\n<p><a href=\"https://www.virtualbox.org/\">https://www.virtualbox.org/</a></p>\n<p>今回は、最新版の 5.0 を使用しています。</p>\n<h1>Vagrant の設定</h1>\n<ul>\n<li>コマンドプロンプトを立ち上げて、仮想環境のフォルダを作成します。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mkdir centos\ncd centos</code></pre></div>\n<p>続けて、以下のコマンドを実行</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vagrant box add CentOS https://f0fff3908f081cb6461b407be80daf97f07ac418.googledrive.com/host/0BwtuV7VyVTSkUG1PM3pCeDJ4dVE/centos7.box\nvagrant plugin install vagrant-vbguest</code></pre></div>\n<p>1 行目は、vagrant の box を指定。以下から目的の box を探して下さい。</p>\n<p><a href=\"http://www.vagrantbox.es/\">http://www.vagrantbox.es/</a></p>\n<p>2 行目は、VirtualBox の Guest Additions を使用するためのプラグインで、私の環境ではインストールしないとエラーが出ました。</p>\n<p><a href=\"http://qiita.com/isaoshimizu/items/e217008b8f6e79eccc85\">http://qiita.com/isaoshimizu/items/e217008b8f6e79eccc85</a></p>\n<br>\n<p>仮想環境を作成します</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vagrant init CentOS\nnotepad.exe Vagrantfile</code></pre></div>\n<p>メモ帳でコンフィグファイルが開くので、以下のように設定</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Vagrant.configure(2) do |config|\n  config.vm.box = &quot;CentOS7&quot;\n  config.vm.network &quot;private_network&quot;, ip: &quot;192.168.33.10&quot; (←コメントアウトを外す)\n  config.vm.synced_folder &quot;../hello&quot;, &quot;/var/www/html/hello&quot; (←お好みで設定、後述)\n  config.vm.provider &quot;virtualbox&quot; do |vb| (←コメントアウトを外す)\n    vb.memory = &quot;1024&quot; (←コメントアウトを外す)\n  end (←コメントアウトを外す)\nend</code></pre></div>\n<p><code class=\"language-text\">config.vm.synced_folder</code>は、CentOS と Host の共有フォルダになります。<br>\n上記の場合だと、ホストの<code class=\"language-text\">../hello</code>フォルダと、ゲストの<code class=\"language-text\">/var/www/html/hello</code>フォルダが共有されることになります。</p>\n<br>\n<p>設定は以上です、仮想環境を起動します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vagrant up\n\nvagrant halt (←停止するとき)\nvagrant reload (←再起動するとき)</code></pre></div>\n<h1>SSH で接続</h1>\n<p>起動したので、SSH で接続します。<br>\nWindows にはコマンドラインで使える SSH クライアントがデフォルトでは存在しないので、今回は putty を使います。</p>\n<p><a href=\"http://www.chiark.greenend.org.uk/~sgtatham/putty/\">http://www.chiark.greenend.org.uk/~sgtatham/putty/</a></p>\n<ul>\n<li>ホスト名：192.168.33.10</li>\n<li>ポート番号：22</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACoklEQVQ4y21U2W7iQBD0///G/sA+bB6iTRY2EYSEhHDfGBxjsDE+8QEKSe1UEyMi7UittsczNdVdNdZKpV+YLxZYmkss5nMYCwO73Q55niHLvsd+v5c4HA4SeZ7LfJqm+Pj4QKPRgNbt9jAajeA4G4RhJEHAMAwRRRGiOEYcn95XqxUsy4JpmjAMA67ryrzv+wLcarWgrdY2FoohF3F8fn5KJog+m0CfjjEYDGTzdDrFcDhEt9tRm5vqAAue58HdbITE6+srNDJbLpdYr9dSRjHSJEFnqKPWHKLZbEFX7di4W+xZ6v4USZphl6QIoxhZvleHtKEVdB8fHzEej8+ghzxFaeDjR9WGbrmYmBvMrK0Enw0ngL7yoK892GEGNzmi3lAl24ohy3l+fpYmFyWT+f3fMiajgfSm1+uhWq2i3W7DeHuDpfqp6zrGkwm2261imMs3rRChXC7jcgRBiNlsJpspGvvYbDYlv6k5ChYrwbg3UFVSaR6qcSOVqtfr3wAT1Rtu7Pf7spCZtiCLTqcjeaYYEjgIAqlOVGZppL5RSl2qnKgTCfLy8iLMeODd3d2Xyl1R1LZtIUOlz7bhxPv7u7DgZDFo4IeHB1xdXUnvrq+vUalUxGL0IIHpSZb9jSEpE6hWqwlIMTjHHlIsMmMUjNlTPtNq3E+nnAHJMMtyMe0lIJs8V95jaSyX7J6enoT17e2tEGDpBD1d1S9AivK/kShjszQ2/+bmRkAJTsZkSfa8XWwBlWfpYhvP8wXgeDzKBT+qoDCxOpX+YsPJgpnCMfu+J5nBNfxOAgLoOI68xPITOP0IGFEUn33G78yMiN92iWSuK+Z5w2gnjb2jwiyJ9uFpZMKDLsPdODBXDiodHT9/3+NPvYvGyMRIqV0qlUQouuEfCj2cUK70A7cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"20160116180844\"\n        title=\"20160116180844\"\n        src=\"/static/6e77e7d10ca5afdff5594372fec25001/e17e5/20160116180844.png\"\n        srcset=\"/static/6e77e7d10ca5afdff5594372fec25001/7e516/20160116180844.png 100w,\n/static/6e77e7d10ca5afdff5594372fec25001/772e8/20160116180844.png 200w,\n/static/6e77e7d10ca5afdff5594372fec25001/e17e5/20160116180844.png 400w,\n/static/6e77e7d10ca5afdff5594372fec25001/44385/20160116180844.png 527w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">20160116180844</figcaption>\n  </figure></p>\n<p>文字コードは UTF-8 にしないと日本語が文字化けます。</p>\n<ul>\n<li>ユーザー名：vagrant</li>\n<li>パスワード：vagrant</li>\n</ul>\n<h1>CentOS の設定</h1>\n<p>環境構築の時のみルート権限になっておきます</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ su -</code></pre></div>\n<p>完全ローカルの開発環境なので、ファイアウォールと SELinux をオフにします</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># systemctl stop firewalld\n# systemctl disable firewalld\n\n# vi /etc/sysconfig/selinux\n&gt; SELINUX=disabled (書き換え)</code></pre></div>\n<h2>yum リポジトリの追加</h2>\n<p>PHP7 を入れる時などに、デフォルトのリポジトリでは 5.3 などとバージョンが古いので、別のリポジトリを追加しておきます。</p>\n<p>しかし、デフォルトでオフにしておき、必要に応じて使うように設定しておきます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum install wget\n# wget http://ftp.iij.ad.jp/pub/linux/fedora/epel/7/x86_64/e/epel-release-7-5.noarch.rpm\n# wget http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\n# wget http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm\n# rpm -Uvh epel-release-7-5.noarch.rpm remi-release-7.rpm rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm</code></pre></div>\n<p>それぞれ、最新は以下から確認できます。</p>\n<ul>\n<li>epel : <a href=\"https://fedoraproject.org/wiki/EPEL/ja\">https://fedoraproject.org/wiki/EPEL/ja</a></li>\n<li>remi : <a href=\"http://rpms.famillecollet.com/\">http://rpms.famillecollet.com/</a></li>\n<li>rpmforge : <a href=\"http://pkgs.repoforge.org/rpmforge-release/\">http://pkgs.repoforge.org/rpmforge-release/</a></li>\n</ul>\n<p>デフォルトでオフになるように設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># vi /etc/yum.repos.d/epel.repo\n&gt; [epel] を enabled=0 に\n# vi /etc/yum.repos.d/epel.repo\n&gt; [remi] を enabled=0 に (私の環境ではデフォルトでオフでした)\n# vi /etc/yum.repos.d/rpmforge.repo\n&gt; [rpmforge] を enabled=0 に</code></pre></div>\n<p>どのリポジトリがデフォルトでオンになっているかは、以下のコマンドで確認できます</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum repolist all</code></pre></div>\n<p><a href=\"http://codaholic.org/?p=1853\">http://codaholic.org/?p=1853</a></p>\n<h1>日本時刻の設定</h1>\n<p>vagrant から導入すると、世界標準時になっているので、日本時間に変更します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum install ntp\n# vi /etc/ntp.conf\n\n&gt; serverを以下に書き換え\nserver -4 ntp.nict.jp\nserver -4 ntp1.jst.mfeed.ad.jp\nserver -4 ntp2.jst.mfeed.ad.jp\nserver -4 ntp3.jst.mfeed.ad.jp\n\n# systemctl start ntpd\n# systemctl enable ntpd.service</code></pre></div>\n<p>タイムゾーンの変更</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># timedatectl set-timezone Asia/Tokyo\n# timedatectl (Asia/Tokyoになっていることを確認)</code></pre></div>\n<h1>Apache</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum install httpd\n# systemctl enable httpd.service</code></pre></div>\n<h1>PHP</h1>\n<p>前述のとおり、デフォルトの yum リポジトリでは PHP5.3 なので、remi のリポジトリを使用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># yum --enablerepo=remi-php70 install php php-pear php-devel php-mbstring php-mysql php-pdo php-xml</code></pre></div>\n<p>確認画面で PHP7.0 であることを確認してインストールします。</p>\n<p>Apache で使えるようにモジュールを include しておきます</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># vi /etc/httpd/conf.d/php.conf\n&gt; LoadModule php7_module   /usr/lib64/httpd/modules/libphp7.so (←先頭行に追加)</code></pre></div>\n<h1>MySQL</h1>\n<p>MySQL の yum リポジトリを追加してそこからインストールします。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># wget http://dev.mysql.com/get/mysql57-community-release-el7-7.noarch.rpm\n# rpm -Uvh mysql57-community-release-el7-7.noarch.rpm\n# yum --enablerepo=mysql57-community install mysql-community-server\n# systemctl enable mysqld.service</code></pre></div>\n<p><a href=\"http://dev.mysql.com/downloads/repo/yum/\">http://dev.mysql.com/downloads/repo/yum/</a></p>\n<p>MySQL は 5.7 から、root ユーザの初期パスワードが MySQL のログに書かれています。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># cat /var/log/mysqld.log | grep &#39;password is generated&#39;\n&gt; [Note] A temporary password is generated for root@localhost: ********\n# mysql -u root -p****** (ログイン)</code></pre></div>\n<p><a href=\"http://qiita.com/ma_me/items/ae449ad8a2c424665310\">http://qiita.com/ma_me/items/ae449ad8a2c424665310</a></p>\n<h1>おしまい</h1>\n<p>以上で完了です。後はお好きに開発を進められますね。</p>\n<p>思い出しながら書いたので、忘れていることがあったらゴメンナサイ。</p>","frontmatter":{"title":"Windows 10 Home 上に Vagrant と VirtualBox で LAMP 開発環境を整える(CentOS7/PHP7)","date":"2016/01/16 19:28","tags":["Vagrant","環境構築"]},"id":"68489f56-0a37-5284-811a-b3204161289e","excerpt":"環境構築したもの Windows 10 Home 側 Vagrant VirtualBox 仮想環境側 CentOS 7.0 x86_64 Apache 2.4.6 MySQL 5.7.10 PHP 7.0.2 Vagrant について これを使うと VirtualBox…"},"relatedPosts":{"edges":[{"node":{"fields":{"slug":"/2016/0116-vagrant-lamp/"},"frontmatter":{"title":"Windows 10 Home 上に Vagrant と VirtualBox で LAMP 開発環境を整える(CentOS7/PHP7)","date":"2016/01/16 19:28","tags":["Vagrant","環境構築"]},"id":"68489f56-0a37-5284-811a-b3204161289e"}},{"node":{"fields":{"slug":"/2016/0116-vagrant-lamp/"},"frontmatter":{"title":"Windows 10 Home 上に Vagrant と VirtualBox で LAMP 開発環境を整える(CentOS7/PHP7)","date":"2016/01/16 19:28","tags":["Vagrant","環境構築"]},"id":"68489f56-0a37-5284-811a-b3204161289e"}}]}},"pageContext":{"slug":"/2016/0116-vagrant-lamp/","tags":["Vagrant","環境構築"]}}}