{"componentChunkName":"component---src-templates-blog-post-js","path":"/2017/0711/","result":{"data":{"site":{"siteMetadata":{"title":"なばろぐ","description":"プログラミング、ピアノ作曲・演奏、雑記など"}},"markdownRemark":{"html":"<div class=\"alert info\">\nはてなブログからの移行記事\n</div>\n<h1>あらすじ</h1>\n<p>Surface Pro 4 + 外部ディスプレイを使っていて、「外部ディスプレイに表示のみ」にした場合に<strong>タッチパネルが反応して外部ディスプレイの操作の邪魔をする</strong>など、一時的にタッチパネルを無効化したい場合もあるかと思います。</p>\n<p>デイバイスマネージャから「HID 準拠タッチ スクリーン」を無効化すれば解決するのですが、いちいち開いて変更するのが面倒なのでバッチファイルを作成して「Win+R」からサクっと呼び出します。</p>\n<br>\n<h1>必要なもの</h1>\n<p>コマンドラインからデバイスの有効・無効化を行うには「DevCon」という\nWindows Driver Kit (WDK) に含まれるソフトを使用するため、WDKをインストールします。</p>\n<p><a href=\"https://developer.microsoft.com/ja-jp/windows/hardware/windows-driver-kit\">https://developer.microsoft.com/ja-jp/windows/hardware/windows-driver-kit</a></p>\n<blockquote>\n<p>重要: WDK をインストールすると、モダン アプリケーションを開発することができなくなります。</p>\n</blockquote>\n<p>と書いてあるのですが、「モダンアプリケーション」が何を指すのかわかりません…。</p>\n<p>また、Visual Studio 2017 とはまだ互換性がないようです。</p>\n<br>\n<h1>バッチファイル</h1>\n<p>まず、「デバイスマネージャ」→「ヒューマン インターフェイス デバイス」→「HID 準拠タッチ スクリーン」のハードウェアIDの一番上の長いものをメモります。（今回は「HID 準拠タッチ スクリーン」は2つあったので両方メモ）</p>\n<p><img src=\"20170711001524.png\" alt=\"20170711001524\"></p>\n<p>その2つに対して、<code class=\"language-text\">devcon</code>コマンドを使用してデバイスを無効化するバッチファイルを作成します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:: devcon.exeのパス（Windows 10 Pro）\n@set DEVCON=&quot;C:\\Program Files (x86)\\Windows Kits\\10\\Tools\\x64\\devcon.exe&quot;\n  \n:: HID タッチスクリーンの無効化\n%DEVCON% disable &quot;メモしたハードウェアID1&quot;\n%DEVCON% disable &quot;メモしたハードウェアID2&quot;</code></pre></div>\n<p>有効化のバッチファイルも、同様に作成します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:: devcon.exeのパス（Windows 10 Pro）\n@set DEVCON=&quot;C:\\Program Files (x86)\\Windows Kits\\10\\Tools\\x64\\devcon.exe&quot;\n  \n:: HID タッチスクリーンの無効化\n%DEVCON% enable &quot;メモしたハードウェアID1&quot;\n%DEVCON% enable &quot;メモしたハードウェアID2&quot;</code></pre></div>\n<br>\n<h1>Win+Rから実行したい</h1>\n<p>このバッチファイルには管理者権限が必要で、それをバッチファイルで書くと大変（というか知らない）ので、<br>\nバッチファイルのショートカットを作成して、その実行に管理者権限が必要なように設定します。</p>\n<p>バッチファイルのショートカットを作成し、「プロパティ」の「詳細設定」から「管理者として実行」にチェックを入れます。</p>\n<p><img src=\"20170711002519.png\" alt=\"20170711002519\"></p>\n<br>\n<p>あとは、このショートカットキーを Path が通っている場所において、Win+Rから叩けば簡単にタッチスクリーンのオンオフを制御することが出来ます。</p>\n<br>\n<h2>参考</h2>\n<p><a href=\"https://qwerty.work/blog/2015/03/wdkdevconbatcommand.php\">https://qwerty.work/blog/2015/03/wdkdevconbatcommand.php</a></p>","frontmatter":{"title":"Surfaceのタッチスクリーンをオンオフするバッチファイルを作った","date":"2017/07/11 00:27","tags":["Windows"]},"id":"ba095510-e369-5f80-acce-22727f3f665e","excerpt":"あらすじ Surface Pro 4 + 外部ディスプレイを使っていて、「外部ディスプレイに表示のみ」にした場合にタッチパネルが反応して外部ディスプレイの操作の邪魔をするなど、一時的にタッチパネルを無効化したい場合もあるかと思います。 デイバイスマネージャから「HID…"},"relatedPosts":{"edges":[{"node":{"fields":{"slug":"/2019/0512/"},"frontmatter":{"title":"【「移動」が使えないとき】Windowsでウインドウが画面外にいってしまったときの戻し方","date":"2019/05/12 09:47","tags":["Windows"]},"id":"5418a627-8302-5056-b8e3-3ad07f384677"}},{"node":{"fields":{"slug":"/2017/0711/"},"frontmatter":{"title":"Surfaceのタッチスクリーンをオンオフするバッチファイルを作った","date":"2017/07/11 00:27","tags":["Windows"]},"id":"ba095510-e369-5f80-acce-22727f3f665e"}}]}},"pageContext":{"slug":"/2017/0711/","tags":["Windows"]}}}